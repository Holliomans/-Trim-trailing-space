# -Trim-trailing-space
Func _StringTranslate($sStr, $vFrom, $sTo = Default)     If Not IsString($sStr) Then Return SetError(1, 1, 0)     If IsArray($vFrom) Then         If 2 > UBound($vFrom, 2) Then Return SetError(1, 4, 0)         Return __StringTranslate_FromArray($sStr, $vFrom)     EndIf     If Not IsString($vFrom) Then Return SetError(1, 2, 0)     If Not IsString($sTo) Then Return SetError(1, 3, 0)     Local $i, $ii, $iMaxSearch, $iMaxReplace, $iMaxASCII     Local $aSearch, $aReplace, $aASCII     $aSearch = StringToASCIIArray($vFrom)     $aReplace = StringToASCIIArray($sTo)     $iMaxSearch = UBound($aSearch) - 1     $iMaxReplace = UBound($aReplace) - 1     If 0 = $iMaxSearch Or 0 = $iMaxReplace Then Return $sStr     If $iMaxSearch > $iMaxReplace Then $iMaxSearch = $iMaxReplace     $aASCII = StringToASCIIArray($sStr)     $iMaxASCII = UBound($aASCII) - 1     For $i = 0 To $iMaxASCII         For $ii = 0 To $iMaxSearch             If $aASCII[$i] = $aSearch[$ii] Then                 $aASCII[$i] = $aReplace[$ii]                 ExitLoop ; Next character.             EndIf         Next     Next     Return StringFromASCIIArray($aASCII) EndFunc  ; Private helper function of _StringTranslate Func __StringTranslate_FromArray($sStr, $aPairs)     Local $i, $ii, $iMaxReplace, $sReturn     Local $aWords = StringSplit($sStr, ' ')     $iMaxReplace = UBound($aPairs) - 1     _ArraySort($aPairs, 1) ; Sort descending, longest matches are replaced.     For $i = 1 To $aWords[0]         For $ii = 0 To $iMaxReplace             If StringInStr($aWords[$i], $aPairs[$ii][0]) Then                 $aWords[$i] = StringReplace($aWords[$i], $aPairs[$ii][0], $aPairs[$ii][1])                 $sReturn &amp;= $aWords[$i] &amp; ' '                 ContinueLoop 2 ; Next sequence, jump back to first loop.             EndIf         Next         $sReturn &amp;= $aWords[$i] &amp; ' '     Next     Return StringTrimRight($sReturn, 1) ; Trim trailing space. EndFunc
